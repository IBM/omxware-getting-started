# Data Description

This folder contains model files (saved using `joblib`) and model classification matrices (saved as csv) to accompany the *Klebsiella* virulence prediction ML results described in [https://github.com/IBM/omxware-getting-started/tree/master/Virulence-Analysis](https://github.com/IBM/omxware-getting-started/tree/master/Virulence-Analysis) and at the citation information below.


## Usage tips:  
- For this work, 48 permutations of model parameters were explored and are surfaced here. The model name is constructed based on the parameters used.
- Each model folder also contains the classification matrix for that model and is generated by [https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html).
- `BASELINE` denotes models trained using only virulence seed data as described in manuscript citation linked below.
- All other models are from the `VIRULENCE++` feature set which is a shorthand here for the "discovery inclusion" features and is further described in the manuscript information indicated below in Citation. Briefly, this was generated from vectorization of thousands of *Klebsiella* genomes as their protein domain architectures and labeled with their virulence categorization based on the sample's isolation source.
- Test sets of the models with congruent parameters for `BASELINE` and `VIRULENCE++` were held constant for comparability. 
- In accordance with the manuscript, for each classification task the best performing models for `VIRULENCE++` and `BASELINE` are as follows:
	- `vir_vs_nvir`: `all hosts_vir_vs_nvir_oversampledFalse_ADASYN_include_non_kp_genomes_NO` and `BASELINE_TUNED_FROM_METADATAall hosts_vir_vs_nvir_oversampledFalse_ADASYN_include_non_kp_genomes_NO`
	-  `hv_vs_lv`: `all hosts_hv_vs_lv_oversampledFalse_ADASYN_include_non_kp_genomes_NO` and `BASELINE_TUNED_FROM_METADATAall hosts_hv_vs_lv_oversampledFalse_ADASYN_include_non_kp_genomes_NO`
- For complete documentation on the data included here as well as for code to load/save models, please see our GitHub: [https://github.com/IBM/omxware-getting-started/tree/master/Virulence-Analysis](https://github.com/IBM/omxware-getting-started/tree/master/Virulence-Analysis) and `src/model/model_utils/machine_learning.py` within that repository.


## Parameter definitions:
- `Baseline_tuned`, `SVM` and `XGBoost` are models saved using `joblib`. `Baseline_tuned` are trained using `XGBoost` as well but on baseline data.
- Model name field string: `<feature_selection><host_selection><classification_task><oversampling><oversampling_method><kp_handling_training>` (sorry this is really long and cumbersome)
- `<feature_selection>`: `BASELINE` or `VIRULENCE++`, **Note:** "virulence++" is not directly listed in the model file name since baseline is the counter example. Code in repo can handle this accordingly.
- `<host_selection>`: `all_hosts` or `human`
- `<classification_task>`: `vir_vs_nvir` or `hv_vs_lv`
- `<oversampling>`: `oversampledTrue` or `oversampledFalse`
- `<oversampling_method>`: if `oversampling` value is `oversampledTrue`, the allowed values are: `ADASYN`, `SMOTE`, `random` and indicate which method was used. If `oversampledFalse` is present, oversampling was not applied, yet the default value (`ADASYN`) will still be written to the string.
- `<kp_handling_training>`:
	- `include_non_kp_genomes_NO` indicates training is only *Klebsiella pneumoniae* genomes
	- `include_non_kp_genomes_TRAINING_ONLY` indicates all *Klebsiella* genomes were used (includes non-Kp)


### Model examples:
1. For example for `BASELINE_TUNED_FROM_METADATAall hosts_hv_vs_lv_oversampledFalse_ADASYN_include_non_kp_genomes_NO` this indicates a baseline model for which hyperparameter tuning was performed during training. Additionally, it has the following characteristics:
    - uses `all hosts` data instead of just `human hosts`
    - `hv_vs_lv` indicates high virulence vs low virulence model (please refer to the paper for more details)
    - `oversampledFalse` indicates that oversampling was not performed on the data
    - `ADASYN` not applicable here, but if `oversampledTrue` was there, then `ADASYN` method would have been used
    - `include_non_kp_genomes_NO` *Klebsiella pneumoniae* (Kp) handling for training i.e. non-kp genomes were not used for training therefore training was targeted only to genomes belonging to *Klebsiella pneumoniae*
2. `BASELINE_TUNED_FROM_METADATAahuman_vir_vs_nvir_oversampledTrue_ADASYN_include_non_kp_genomes_TRAINING_ONLY` this indicates a baseline model for which hyperparameter tuning was performed during training. Additionally, it has the following characteristics:
    - uses `human` data instead of just `all hosts`
    - `vir_vs_nvir` indicates virulent vs not virulent model (please refer to the paper for more details)
    - `oversampledTrue` indicates that oversampling was performed on the data
    - `ADASYN` oversampling method used
    - `include_non_kp_genomes_TRAINING_ONLY` all *Klebsiella* genomes were used. Using non-kp for testing can be done separately and is provided as an option in the `virulence++_testing.py` and `baseline_training_testing.py`.
3. `all hosts_hv_vs_lv_oversampled_False_ADASYN_include_non_kp_genomes_NO` this indicates a virulence++ model for which hyperparameter tuning was performed during training. Additionally, it has the following characteristics:
    - uses `all hosts` data instead of just `human hosts`
    - `hv_vs_lv` indicates high virulence vs low virulence model (please refer to the paper for more details)
    - `oversampledFalse` indicates that oversampling was not performed on the data
    - `ADASYN` not applicable here, but if `oversampledTrue` was there, then `ADASYN` method would have been used
    - `include_non_kp_genomes_NO` this is for training i.e. non-kp genomes were not used for training therefore the training set consisted only of *Klebsiella pneumoniae* genomes



### List of files:
<details>
  <summary> Expand
  	</summary>

```
├── BASELINE_TUNED_MODELS
│   ├── BASELINE_TUNED_FROM_METADATAall hosts_hv_vs_lv_oversampledFalse_ADASYN_include_non_kp_genomes_NO
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAall hosts_hv_vs_lv_oversampledFalse_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAall hosts_hv_vs_lv_oversampledTrue_ADASYN_include_non_kp_genomes_NO
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAall hosts_hv_vs_lv_oversampledTrue_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAall hosts_vir_vs_nvir_oversampledFalse_ADASYN_include_non_kp_genomes_NO
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAall hosts_vir_vs_nvir_oversampledFalse_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAall hosts_vir_vs_nvir_oversampledTrue_ADASYN_include_non_kp_genomes_NO
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAall hosts_vir_vs_nvir_oversampledTrue_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAhuman_hv_vs_lv_oversampledFalse_ADASYN_include_non_kp_genomes_NO
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAhuman_hv_vs_lv_oversampledFalse_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAhuman_hv_vs_lv_oversampledTrue_ADASYN_include_non_kp_genomes_NO
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAhuman_hv_vs_lv_oversampledTrue_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAhuman_vir_vs_nvir_oversampledFalse_ADASYN_include_non_kp_genomes_NO
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAhuman_vir_vs_nvir_oversampledFalse_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   ├── BASELINE_TUNED_FROM_METADATAhuman_vir_vs_nvir_oversampledTrue_ADASYN_include_non_kp_genomes_NO
│   │   ├── Baseline_tuned
│   │   └── Baseline_tuned_classification_matrix.csv
│   └── BASELINE_TUNED_FROM_METADATAhuman_vir_vs_nvir_oversampledTrue_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│       ├── Baseline_tuned
│       └── Baseline_tuned_classification_matrix.csv
├── VIRULENCE++_MODELS
│   ├── TESThuman_hv_vs_lv_oversampled_True_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   └── SVM_classification_matrix.csv
│   ├── all hosts_hv_vs_lv_oversampled_False_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── all hosts_hv_vs_lv_oversampled_False_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── all hosts_hv_vs_lv_oversampled_True_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── all hosts_hv_vs_lv_oversampled_True_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── all hosts_vir_vs_nvir_oversampled_False_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── all hosts_vir_vs_nvir_oversampled_False_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── all hosts_vir_vs_nvir_oversampled_True_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── all hosts_vir_vs_nvir_oversampled_True_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── human_hv_vs_lv_oversampled_False_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── human_hv_vs_lv_oversampled_False_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── human_hv_vs_lv_oversampled_True_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── human_hv_vs_lv_oversampled_True_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── human_vir_vs_nvir_oversampled_False_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── human_vir_vs_nvir_oversampled_False_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   ├── human_vir_vs_nvir_oversampled_True_ADASYN_include_non_kp_genomes_NO
│   │   ├── SVM
│   │   ├── SVM_classification_matrix.csv
│   │   ├── XGBoost
│   │   └── XGBoost_classification_matrix.csv
│   └── human_vir_vs_nvir_oversampled_True_ADASYN_include_non_kp_genomes_TRAINING-ONLY
│       ├── SVM
│       ├── SVM_classification_matrix.csv
│       ├── XGBoost
│       └── XGBoost_classification_matrix.csv
```
</details>

### Citation:
Please see our GitHub [https://github.com/IBM/omxware-getting-started/tree/master/Virulence-Analysis](https://github.com/IBM/omxware-getting-started/tree/master/Virulence-Analysis) for the most current citation information.
